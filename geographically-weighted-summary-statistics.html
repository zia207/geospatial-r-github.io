<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Geographically Weighted Summary Statistics</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.0.13/css/fa-svg-with-js.css" rel="stylesheet" />
<script src="site_libs/font-awesome-5.0.13/js/fontawesome-all.min.js"></script>
<script src="site_libs/font-awesome-5.0.13/js/fa-v4-shims.min.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Geospatial Data Science</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Spatial Data Processing with R
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="about.html">Content</a>
    </li>
    <li>
      <a href="getting-started-with-r.html">Getting Started with R</a>
    </li>
    <li>
      <a href="read-write-spatial-data.html">Read and Write Spatial Data in R</a>
    </li>
    <li>
      <a href="map-projection-coordinate-reference-systems.html">Map Projection and Coordinate Reference Systems</a>
    </li>
    <li>
      <a href="geoprocessing-vector-data.html">Geoprocessing of Vector data</a>
    </li>
    <li>
      <a href="working-with-spatial-point-data.html">Working with Spatial Point Data</a>
    </li>
    <li>
      <a href="working-with-spatial-polygon.html">Working with Spatial Polygon Data</a>
    </li>
    <li>
      <a href="working-with-raster-data.html">Working with Raster Data</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Spatial Statistics with R
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="about-b.html">Content</a>
    </li>
    <li>
      <a href="spatial-statistics.html">Spatial Statistics</a>
    </li>
    <li>
      <a href="spatial-autocorrelation.html">Spatial Autocorrelation</a>
    </li>
    <li>
      <a href="geographically-weighted-models.html">Geographically Weighted Model</a>
    </li>
    <li>
      <a href="geographically-weighted-summary-statistics.html">Geographically Weighted Summary Statistics</a>
    </li>
    <li>
      <a href="geographically-weighted-principal-components-analysis.html">Geographically Weighted Principal Components Analysis</a>
    </li>
    <li>
      <a href="geographically-weighted-regression.html">Geographically Weighted Regression</a>
    </li>
    <li>
      <a href="spatial-interpolation.html">Spatial Interpolation</a>
    </li>
    <li>
      <a href="deterministic-methods-for-spatial-interpolation.html">Deterministic Methods for Spatial Interpolation</a>
    </li>
    <li>
      <a href="geostatistical-methods-for-spatial-interpolation.html">Geostatistical Methods for Spatial Interpolation</a>
    </li>
    <li>
      <a href="semivariogram-modeling.html">Semivariogram Modeling</a>
    </li>
    <li>
      <a href="kriging.html">Kriging</a>
    </li>
    <li>
      <a href="ordinary-kriging.html">Ordinary Kriging</a>
    </li>
    <li>
      <a href="universal-kriging.html">Universal Kriging</a>
    </li>
    <li>
      <a href="cokriging.html">Co-Kriging</a>
    </li>
    <li>
      <a href="regression-kriging.html">Regression kriging</a>
    </li>
    <li>
      <a href="indicator-kriging.html">Indicator kriging</a>
    </li>
    <li>
      <a href="assessing-quality-spatial-predictions.html">Assessing the Quality of Spatial Predictions</a>
    </li>
    <li>
      <a href="cross-validation.html">Cross-validation</a>
    </li>
    <li>
      <a href="validation-independent-dataset.html.">Validation with an Independent Dataset</a>
    </li>
    <li>
      <a href="conditional-simulation-spatial-uncertainty.html">Conditional Simulation for Spatial Uncertainty</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Remote Sensing Data with R
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="about-c.html">Content</a>
    </li>
    <li>
      <a href="reomte-sensing-basic.html">Remote Sensing Basic</a>
    </li>
    <li>
      <a href="landsat-8-image-processing.html">Landsat 8 Image Processing &amp; Visualization</a>
    </li>
    <li>
      <a href="spectral-indices.html">Spectral Indices</a>
    </li>
    <li>
      <a href="uav-ground-cover.html">Green Ground Cover from UAV Images</a>
    </li>
    <li>
      <a href="texture-analysis.html">Texture Analysis</a>
    </li>
    <li>
      <a href="image-classification.html">Image Classification</a>
    </li>
    <li>
      <a href="ground-truth-data-processing.html">Ground Truth Data Processing</a>
    </li>
    <li>
      <a href="unsupervised-classification.html">Unsupervised Classification</a>
    </li>
    <li>
      <a href="supervised-classification.html">Supervised Classification</a>
    </li>
    <li>
      <a href="random-forest.html">Random Forest</a>
    </li>
    <li>
      <a href="support-vector-machine.html">Support Vector Machine</a>
    </li>
    <li>
      <a href="naive-bayes.html">Naïve Bayes</a>
    </li>
    <li>
      <a href="exboost.html">eXtreme Gradient Boosting</a>
    </li>
    <li>
      <a href="deep-learning-h2o.html">Deep Learning with H20</a>
    </li>
    <li>
      <a href="dnn-keras-tensorflow.html">Deep Learning with Keras-TensorFlow</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="mailto:zia207@gmail.com">
    <span class="fa fa-envelope fa-lg"></span>
     
    Email
  </a>
</li>
<li>
  <a href="http://github.com/zia207">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://www.linkedin.com/in/zia-ahmed-a7653578">
    <span class="fa fa-linkedin fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Geographically Weighted Summary Statistics</h1>

</div>


<div style="margin-bottom:40px;">

</div>
<p>This lessons we will show GW modelling with GW summary statistics (Bruns-don et al. 2002; Fotheringham et al. 2002). Here, we will leanr how to calculate GW means, GW standard deviations, GW measures of skew and GW correlations which constitute a set of basic GW summary statistics.</p>
<div id="load-r-packages" class="section level4">
<h4>Load R packages</h4>
<pre class="r"><code>library(GWmodel)      ### GW models
library(sp)           ## Data management
library(spdep)        ## Spatial autocorrelation
library(gstat)        ## Geostatistics
library(RColorBrewer) ## Visualization
library(classInt)     ## Class intervals
library(raster)       ## spatial data
library(gridExtra)    # Multiple plot
library(ggplot2)      # Multiple plot</code></pre>
</div>
<div id="load-data" class="section level4">
<h4>Load Data</h4>
<p>The spatial polygon of lung cancer mortality rate and envrionmental covariate data could be found <a href="https://www.dropbox.com/s/d6nnlu2da93mp48/DATA_08.7z?dl=0">here</a>.</p>
<pre class="r"><code># Define data folder
dataFolder&lt;-&quot;F:\\Spatial_Data_Processing_and_Analysis_R\\Data\\DATA_08\\&quot;
COUNTY&lt;-shapefile(paste0(dataFolder,&quot;COUNTY_ATLANTIC.shp&quot;))
state&lt;-shapefile(paste0(dataFolder,&quot;STATE_ATLANTIC.shp&quot;))
df&lt;-read.csv(paste0(dataFolder,&quot;data_atlantic_1998_2012.csv&quot;), header=T)</code></pre>
</div>
<div id="create-a-data-frame" class="section level4">
<h4>Create a data frame</h4>
<pre class="r"><code>df[5] &lt;- lapply(df[5], as.numeric) # Cancer data to numeric
SPDF&lt;-merge(COUNTY,df, by=&quot;FIPS&quot;)
names(SPDF)</code></pre>
<pre><code>##  [1] &quot;FIPS&quot;       &quot;ID&quot;         &quot;x.x&quot;        &quot;y.x&quot;        &quot;REGION_ID&quot; 
##  [6] &quot;DIVISION_I&quot; &quot;STATE_ID&quot;   &quot;COUNTY_ID&quot;  &quot;REGION&quot;     &quot;DIVISION&quot;  
## [11] &quot;STATE&quot;      &quot;COUNTY&quot;     &quot;x.y&quot;        &quot;y.y&quot;        &quot;pop&quot;       
## [16] &quot;cancer&quot;     &quot;poverty&quot;    &quot;smoking&quot;    &quot;PM25&quot;       &quot;NO2&quot;       
## [21] &quot;SO2&quot;</code></pre>
<pre class="r"><code>polys&lt;- list(&quot;sp.lines&quot;, as(state, &quot;SpatialLines&quot;), col=&quot;grey&quot;, lwd=.8,lty=1)
col.palette&lt;-colorRampPalette(c(&quot;blue&quot;,  &quot;sky blue&quot;, &quot;green&quot;,&quot;yellow&quot;, &quot;red&quot;),space=&quot;rgb&quot;,interpolate = &quot;linear&quot;)</code></pre>
<div style="margin-bottom:42px;">

</div>
<p>We will use <strong>gwss()</strong> function to GW GW summary statistics of cancer rate and PM25, also pearson correlation coefficents between these two variables. We will use ** bandwith (bw)** = 48 and “bisqure” kerbel function. There are five kernel functions available in GW package:</p>
<div style="margin-bottom:20px;">

</div>
<ul>
<li><p>gaussian: wgt = exp(-.5*(vdist/bw)^2);</p></li>
<li><p>exponential: wgt = exp(-vdist/bw);</p></li>
<li><p>bisquare: wgt = (1-(vdist/bw)<sup>2)</sup>2 if vdist &lt; bw, wgt=0 otherwise;</p></li>
<li><p>tricube: wgt = (1-(vdist/bw)<sup>3)</sup>3 if vdist &lt; bw, wgt=0 otherwise;</p></li>
<li><p>boxcar: wgt=1 if dist &lt; bw, wgt=0 otherwise</p></li>
</ul>
<div style="margin-bottom:20px;">

</div>
<p>If adaptive kernel = **TRUE*, means the bandwidth (bw) corresponds to the number of nearest neighbours (i.e. adaptive distance); default is FALSE, where a fixed kernel is found (bandwidth is a fixed distance)</p>
<p>After running gwss(), following output will be created:</p>
<ul>
<li><p>X_LM GW mean</p></li>
<li><p>X_LSD GW Standard deviation</p></li>
<li><p>X_Lvar GW Variance GW Standard deviation squared</p></li>
<li><p>X_LSKe GW Skewness</p></li>
<li><p>X_LCV GW Coefficient of variation GW mean divided by GW Standard deviation</p></li>
<li><p>Cov_X.Y GW Covariance</p></li>
<li><p>Corr_X.Y GW Pearson Correlation</p></li>
</ul>
<p>Note that X and Y should be replaced by the names of the actual variables being investigated.</p>
<div style="margin-bottom:20px;">

</div>
</div>
<div id="lung-cancer-vs-pm2.5" class="section level3">
<h3>Lung cancer vs PM2.5</h3>
<pre class="r"><code>gwss.pm25 &lt;- gwss(SPDF,vars = c(&quot;cancer&quot;, &quot;PM25&quot;),
               kernel=&quot;bisquare&quot;, adaptive=TRUE, bw=48)</code></pre>
<pre class="r"><code>gwss.pm25</code></pre>
<pre><code>##    ***********************************************************************
##    *                       Package   GWmodel                             *
##    ***********************************************************************
## 
##    ***********************Calibration information*************************
## 
##    Local summary statistics calculated for variables:
##     cancer PM25
##    Number of summary points: 666
##    Kernel function: bisquare 
##    Summary points: the same locations as observations are used.
##    Adaptive bandwidth: 48 (number of nearest neighbours)
##    Distance metric: Euclidean distance metric is used.
## 
##    ************************Local Summary Statistics:**********************
##    Summary information for Local means:
##                Min. 1st Qu. Median 3rd Qu.   Max.
##    cancer_LM 52.780  64.937 69.631  73.579 92.558
##    PM25_LM   19.998  24.872 26.294  27.119 31.146
##    Summary information for local standard deviation :
##                  Min. 1st Qu.  Median 3rd Qu.    Max.
##    cancer_LSD  4.7659  7.7152  9.1053 10.8309 16.2608
##    PM25_LSD    1.1285  2.0743  2.4853  3.0355  5.0165
##    Summary information for local variance :
##                    Min.  1st Qu.   Median  3rd Qu.    Max.
##    cancer_LVar  22.7135  59.5248  82.9064 117.3081 264.413
##    PM25_LVar     1.2734   4.3026   6.1765   9.2140  25.165
##    Summary information for Local skewness:
##                    Min.  1st Qu.   Median  3rd Qu.   Max.
##    cancer_LSKe -1.20800 -0.15435  0.13821  0.42117 1.8327
##    PM25_LSKe   -2.46009 -1.20737 -0.82817 -0.48497 0.5996
##    Summary information for localized coefficient of variation:
##                   Min.  1st Qu.   Median  3rd Qu.   Max.
##    cancer_LCV 0.068524 0.113617 0.131623 0.155867 0.2273
##    PM25_LCV   0.040098 0.076753 0.093921 0.122776 0.2270
##    Summary information for localized Covariance and Correlation between these variables:
##                                 Min.  1st Qu.   Median  3rd Qu.    Max.
##    Cov_cancer.PM25          -3.40683  8.16075 14.69411 22.66243 60.9193
##    Corr_cancer.PM25         -0.18652  0.48146  0.62714  0.74329  0.9207
##    Spearman_rho_cancer.PM25 -0.14856  0.40891  0.59095  0.71518  0.8852
## 
##    ************************************************************************</code></pre>
<pre class="r"><code>p1.pm25&lt;-spplot(gwss.pm25$SDF,&quot;cancer_LM&quot;, main = &quot;Local Mean of Lung Cancer&quot;, 
       sp.layout=list(polys),
       col=&quot;transparent&quot;,
       col.regions=col.palette(100))

p2.pm25&lt;-spplot(gwss.pm25$SDF,&quot;PM25_LM&quot;, main = &quot;Local Mean of PM2.5&quot;, 
       sp.layout=list(polys),
       col=&quot;transparent&quot;,
       col.regions=col.palette(100))

p3.pm25&lt;-spplot(gwss.pm25$SDF,&quot;Corr_cancer.PM25&quot;, main = &quot;Local Pearson Correlation&quot;, 
       sp.layout=list(polys),
       col=&quot;transparent&quot;
        )</code></pre>
<pre class="r"><code>grid.arrange(p1.pm25, p2.pm25, p3.pm25, ncol=3)</code></pre>
<p><img src="geographically-weighted-summary-statistics_files/figure-html/unnamed-chunk-8-1.png" width="960" style="display: block; margin: auto;" /></p>
<div style="margin-bottom:20px;">

</div>
</div>
<div id="lung-cancer-vs-smoking" class="section level3">
<h3>Lung cancer vs Smoking</h3>
<pre class="r"><code>gwss.smok&lt;- gwss(SPDF,vars = c(&quot;cancer&quot;, &quot;smoking&quot;),
               kernel=&quot;bisquare&quot;, adaptive=TRUE, bw=48)</code></pre>
<pre class="r"><code>p1.smok&lt;-spplot(gwss.smok$SDF,&quot;cancer_LM&quot;, main = &quot;Local Mean of Lung Cancer&quot;, 
       sp.layout=list(polys),
       col=&quot;transparent&quot;,
       col.regions=col.palette(100))

p2.smok&lt;-spplot(gwss.smok$SDF,&quot;smoking_LM&quot;, main = &quot;Local Mean Smoking Prevelance&quot;, 
       sp.layout=list(polys),
       col=&quot;transparent&quot;,
       col.regions=col.palette(100))

p3.smok&lt;-spplot(gwss.smok$SDF,&quot;Corr_cancer.smoking&quot;, main = &quot;Local Pearson Correlation&quot;, 
       sp.layout=list(polys),
       col=&quot;transparent&quot;
        )</code></pre>
<pre class="r"><code>grid.arrange(p1.smok, p2.smok, p3.smok, ncol=3)</code></pre>
<p><img src="geographically-weighted-summary-statistics_files/figure-html/unnamed-chunk-11-1.png" width="960" style="display: block; margin: auto;" /></p>
<div style="margin-bottom:20px;">

</div>
</div>
<div id="lung-cancer-vs-poverty" class="section level3">
<h3>Lung cancer vs Poverty</h3>
<pre class="r"><code>gwss.pov&lt;- gwss(SPDF,vars = c(&quot;cancer&quot;, &quot;poverty&quot;),
               kernel=&quot;bisquare&quot;, adaptive=TRUE, bw=48)</code></pre>
<pre class="r"><code>p1.pov&lt;-spplot(gwss.pov$SDF,&quot;cancer_LM&quot;, main = &quot;Local Mean of Lung Cancer&quot;, 
       sp.layout=list(polys),
       col=&quot;transparent&quot;,
       col.regions=col.palette(100))

p2.pov&lt;-spplot(gwss.pov$SDF,&quot;poverty_LM&quot;, main = &quot;Local Mean Poverty&quot;, 
       sp.layout=list(polys),
       col=&quot;transparent&quot;,
       col.regions=col.palette(100))

p3.pov&lt;-spplot(gwss.pov$SDF,&quot;Corr_cancer.poverty&quot;, main = &quot;Local Pearson Correlation&quot;, 
       sp.layout=list(polys),
       col=&quot;transparent&quot;
        )</code></pre>
<pre class="r"><code>grid.arrange(p1.pov, p2.pov, p3.pov, ncol=3)</code></pre>
<p><img src="geographically-weighted-summary-statistics_files/figure-html/unnamed-chunk-14-1.png" width="960" style="display: block; margin: auto;" /></p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
